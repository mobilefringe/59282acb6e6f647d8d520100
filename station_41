<style>
    .gallery_image {
        max-width: 100%;
    }
</style>
<!-- GALLERY MODAL -->
<div class="custom-modal-backdrop"></div>
<div class="custom_modal">
    <span class="modal_close"><i class="fa fa-times" aria-hidden="true"></i></span>
    <a class="open_details_modal" id="prev" data-modal-id="id">
        <i class="fa fa-chevron-left prev_arrow" aria-hidden="true"></i>
    </a>
    <a class="open_details_modal" id="next" data-modal-id="id">
        <i class="fa fa-chevron-right next_arrow" aria-hidden="true"></i>
    </a>
    <div class="modal_50">
        <img class="modal_img" src="http://placehold.it/337x337" />
    </div>
    <div class="modal_50">
        <h4 id="modal_name">Heading</h4>
        <p id ="modal_desc">desc</p>
    </div>
    <div class="clearfix"></div>
</div>
<!-- -->
<div class="station_header">   
    <div class="site_container">
        <div class="header_content">
            <div class="row">
                <div class="col-md-12">
                    <hr>
                    <h1>Station 41</h1>
                    <hr>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="site_container">
    <div class="row">
        <div class="col-md-12">
            <h3 class="center" id="mm_page_content"></h3>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <img class="video_still" src="//codecloud.cdn.speedyrails.net/sites/59282acb6e6f647d8d520100/image/png/1496328770000/station41_screenshot.png" alt="Station 41"/>
        </div>
    </div>
    <div class="row">
        <div id="gallery_container">
            <script id="gallery_template" type="x-tmpl-mustache/text">
                <div class="col-md-3">
                    <div class="gallery_content">
                        <div class="gallery_image">
                            <a class="open_details_modal" data-modal-id="{{id}}">
                                <img src="{{gallery_image}}">
                            </a>
                        </div>
                    </div>
                </div>
            </script>
        </div>
    </div>
    <div class="row">
        <h2 class="leasing_title center caps">Contact Leasing</h2>  
        <h3 class="margin_20 center">To explore leasing opportunities at The Gateway, please call Mountain West Commercial Real Estate at 801-456-8800 or visit <a href="//www.mtnwest.com" target="_blank">mtnwest.com</a>.</h3>
        <div class="thick_line_center"></div>
    </div>
</div>
<script>
    $(document).ready(function(e){
        init(e);
        function renderAll(){
            var repo = getRepoDetailsByName("Station41 Banner").images[0];
            var banner = getImageURL(repo.photo_url);
            $(".station_header").css({backgroundImage: "url(" + banner + ")"});
            
            var gallery = getFashionBySlug("thegateway-station-41").fashion_images;
            console.log(gallery);
            renderGallery("#gallery_container", "#gallery_template", gallery);
            
            var id_list = [];
            $.each(gallery, function(key, val) {
                var id = val.id;
                id_list.push(val.id);
            });
            
            var window_width = $( window ).width();
            if (window_width < 769) {
                $('a').removeClass('open_details_modal');
            }
            $('.custom-modal-backdrop').click(function(){
                $('body').removeClass('gallery_no_scroll');
                $('.custom_modal').fadeOut();
                $('.custom-modal-backdrop').fadeOut();
            });
            
            $('.modal_close').click(function(){
                $('body').removeClass('gallery_no_scroll');
                $('.custom_modal').fadeOut();
                $('.custom-modal-backdrop').fadeOut();
            });
        
            $('.open_details_modal').click(function(e){
                e.preventDefault();
                $('body').addClass('gallery_no_scroll');
                
                var modal_id = $(this).attr('data-modal-id');
                $.each(gallery, function(fi_i, fi_val){
                    if (fi_val.id == modal_id){
                        fi = fi_val;
                    }
                });
                var current_id = fi.id;
                var index = id_list.indexOf(current_id);
                if(index >= 0 && index < id_list.length){
                   var next = id_list[index + 1];
                   $('.next_arrow').show();
                   if(next === undefined) {
                       $('.next_arrow').hide();
                   }
                }
                if(index >= 0 && index < id_list.length){
                   var prev = id_list[index - 1];
                   $('.prev_arrow').show();
                   if(prev === undefined) {
                       $('.prev_arrow').hide();
                   }
                }
                $('.custom-modal-backdrop').fadeIn();
                $('.custom_modal').fadeIn();
                $('.modal_img').attr('src', fi.gallery_image);
                $('#modal_name').html(fi.caption);
                $('#modal_desc').html(fi.description);
                $('#prev').attr('data-modal-id', prev);
                $('#next').attr('data-modal-id', next);
            });
        
            var prefix = get_prefix();
            var pages_json = prefix + "/pages/thegateway-station41.json"
            $.getJSON(pages_json).done(function(data) {
                $('#mm_page_content').html(data.body);
            }).fail(function(jqXHR) {
                if (jqXHR.status == 404) {
                    $("#404_msg").fadeIn("fast");
                }
            }); 
        
            show_content();
        }
        loadMallDataCached(renderAll); 
    });
</script>