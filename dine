<div class="page_header no_margin">   
    <div class="site_container">
        <div class="header_content">
            <div class="row">
                <div class="col-md-12">
                    <hr>
                    <h1>Dining</h1>
                    <hr>
                </div>
            </div>
        </div>
    </div>
</div>
<div>
    <div class="directory_header">
        <div class="site_container">
            <div class="row bold">
                <div class="col-md-4">
                    <div class="store_search" >
                        <label class="">
                            <input type="text" placeholder="Find Your Restaurant" id="store_search" />
                            <img src="//codecloud.cdn.speedyrails.net/sites/5a57a7d06e6f6428f0080000/image/png/1515697846000/searchicon@2x.png" class="pull-right" id="store_search_img" alt="">
                            <i id="close_search_results" class="fa fa-times-circle hidden_now"></i>
                        </label>
                        <div class="search_results" id="store_search_results"></div>
                    </div>
                </div>
                <div class="col-md-4"></div>
                <div class="col-md-4 hidden_phone">
                    <a href="/map" class="directory_link">
                        <div class="promotions_header_container directory_btn">View Map</div>
                    </a>
                </div>
            </div> 
        </div>
        <hr>
    </div>
</div>
<div class="site_container page_content">
    <div class="row">
        <div id="store_list_container">
            <script id="store_list_template" type="x-tmpl-mustache/text">
                <div class="col-xs-6 col-sm-3 col-md-2 cats_row" data-cat="{{cat_list}}">
                    <div class="store_logo_container" id="{{initial}}">
                        <a href="/stores/{{slug}}">
                            <img class="store_img" style="{{initial_img}}" src="{{store_front_url_abs}}"/>
                            <img class="store_hover" style="{{initial_img}}" src="{{hover_img}}"/>
                            <div class="store_coming_soon" style="{{coming_soon_store}}">
                                <div class="new_store">Coming soon</div>
                            </div>
                            <div class="store_list_promos">
                                <span class="promo_exist" style="{{job_exist}}"><img src="//codecloud.cdn.speedyrails.net/sites/58bdb9106e6f644783090000/image/png/1489000358000/jobs.png" class="" alt=""> {{job_list}}</span>
                                <span class="promo_exist" style="{{promotion_exist}}"><img src="//codecloud.cdn.speedyrails.net/sites/58bdb9106e6f644783090000/image/png/1489000371000/promotions.png" class="" alt=""> {{promotion_list}}</span>
                            </div>
                        </a>
                    </div>
                </div>
            </script>
        </div>
    </div>
</div>
<script>
$(document).ready(function(e){
    init(e);
    function renderAll(){
        var repo = getRepoDetailsByName("Dine Banner");
        if (repo != undefined) {
            try {
                var banner = getImageURL(repo.images[0].photo_url);
                $(".page_header").css({backgroundImage: "url(" + banner + ")"});    
            } catch(err) {
                console.log(err);
            }
        }
        
        var restaurants = getStoresListByCategoryID(5177);
        var specialty_foods = getStoresListByCategoryID(5174);

        var dine_list = restaurants.concat(specialty_foods).sortBy(function(o){ return o.name});
        var sorted_list = _.uniq(dine_list, function(o){ return o.name; });
        renderStoreList('#store_list_container','#store_list_template', sorted_list, "stores");
        
        show_content();
        
        store_search();
        
        var window_width = $( window ).width();
        if (window_width > 769) {
            $(".store_logo_container").hover(function() {
                $(".store_img", this).hide();
                $(".store_hover", this).show();
            }, function() {
                $(".store_img", this).show();
                $(".store_hover", this).hide();
            });
        }
    }
    loadMallDataCached(renderAll); 
});
</script>